<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>Chat</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.0/socket.io.js"></script>
    <script>try{let date=localStorage.getItem('created_date');let name=localStorage.getItem('name');let pass=localStorage.getItem('pass');let id=localStorage.getItem('id');let main_date={{created_date | tojson}};function id_post(){var form=document.createElement('form');form.action='/Connect/sign';form.method='POST';document.body.appendChild(form);form.addEventListener('formdata',(e)=>{var fd=e.formData;fd.set('name', name);fd.set('pass', pass);alert('サーバーが更新されたため、IDを再度設定します。');});form.submit();}if(name==null || pass==null){location.href="/Connect/homepage";}else if(date==null || date!=main_date || id==null){id_post();}}catch(e){alert(e)}</script>
  </head>
  <body>
    <input type="button" value="チャットルーム作成" onclick="make_room();">
    <ul id="roomlist"></ul>
    チャットルーム名:<input type="text" placeholder="名前">
    <script>
      var socket = io();
      let chat_room = localStorage.getItem('Chat/chat_room');
      let room = localStorage.getItem('room');
      let name = localStorage.getItem('name');
      let id = localStorage.getItem('id');
      let roomlist_id = document.getElementById('roomlist');

      

      function add_li(){
        if(chat_room != null){
          chat_room = chat_room.split(',');
          for(let k of chat_room){
            let k_li = document.createElement('li');
            let k_a  = document.createElement("a");
            k_a.text = k;
            k_a.href = "./room?chatname="+k;
            k_li.appendChild(k_a);
            //k_li.textContent = k;
            roomlist_id.appendChild(k_li);
          }
        } else {
          let k_li = document.createElement('li');
          k_li.textContent = 'どのチャットルームにも所属していません。';
          roomlist_id.appendChild(k_li);
        }
      }

      function make_room(){
        let name_k = prompt('チャットルーム名:','');
      }
    </script>
  </body>
</html>
