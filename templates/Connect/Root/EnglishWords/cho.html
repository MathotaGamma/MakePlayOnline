<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>MPGinW/英単語</title>
    <style>
      *{
        margin: 0px;
        padding: 0px;
      }

      #min {
        width: 50px;
      }

      #max {
        width: 50px;
      }

      #answer_box {
        position: absolute;
        bottom: 50px;
        left: 0px;
        width: 100%;
        height: 50%;
        display: grid;
        grid-template: 1fr 1fr / 1fr 1fr;
      }

      .box {
        display: flex;
        border: 1px solid black;
        border-radius: 5px;
        font-size: auto;
        justify-content: center;
        align-items: center;
      }

    </style>
  </head>
  <body>
    <div id="menu_par">
      <input type="number" id="min" min="1" max="1900" value="1">~<input type="number" id="max" min="1" max="190" value="1900"><br>
      <input type="radio" name="mode" value="normal" checked>通常
      <input type="radio" name="mode" value="weak">苦手特訓モード<br>
      <input type="button" value="開始" onclick="start_click();">
    </div>
    <div id="answer_box">
      <div class="box" id="box_1">1</div>
      <div class="box" id="box_2">2</div>
      <div class="box" id="box_3">3</div>
      <div class="box" id="box_4">4</div>
    </div>
    
    <script>
      const filePath = "/Static/EnglishWords/words_data.txt";
      let len = 0;
      let Words = [];
      let words = [];

      let state = "menu";
      

      const menu_id = document.getElementById('menu_par');

      const answer_box = document.getElementById('answer_box');

      answer_box.style.display = 'none';



      let until_num = localStorage.getItem('English_Words');
      if (until_num == null) {
        until_num = new Array(1900).fill("0");
        localStorage.setItem('English_Words', until_num.join(','));
      } else {
        until_num = until_num.split(',');
      }



      
      fetch(filePath)
        .then(response => response.text())
        .then(data => {
        //alert('get');
            
          Words = data.split('\n').map((k) => {
            let k_k = k.split(/(:|\/)/);
            return [k_k[0],k_k[2],k_k.slice(4)];
          });
          words = structuredClone(Words);
          //words = Words.slice(parseInt(params[0])-1,parseInt(params[1]));
          
          //alert(words);
          len = words.length;
          alert(words.join(','));
        })

      function menu(){
        if(state == "menu"){
          menu_id.style.display = 'none';
        }
      }

      function shuffle(k_get_arr){
        let k = structuredClone(k_get_arr);
        let k_arr = [];
        for(let k_ind = 0; k_ind < k.length; k_ind++){
          let k_rand = Math.floor((k.length-k_ind)*Math.random());
          k_arr.push(k[k_rand]);
          k.slice(k_rand,k_rand);
        }
        return structuredClone(k_arr);
      }

      setTimeout(() => {
        alert(shuffle(Words));
      },3000);

      function start_click(){
        let k_elements = document.getElementsByName('mode');
        let mode = '';
        for (let i = 0; i < k_elements.length; i++){
          if (k_elements.item(i).checked){
            mode = k_elements.item(i).value;
            break;
          }
        }
        if(state == "menu"){
          state = "play";
        } else {
          state = "menu";
        }

        if(state == "play"){
          menu_id.style.display = 'none';
          answer_box.style.display = 'grid';
        } else {
          menu_id.style.display = 'block';
          answer_box.style.display = 'none';
        }
      
        
      }
      
      
    </script>
  </body>
</html>
